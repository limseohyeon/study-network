# 1. HTTP 메시지

---

HTTP 메시지란 HTTP에서 교환하는 정보이다.

리퀘스트 측 메시지를 리퀘스트 메시지, 리스폰스 측 메시지를 리스폰스 메시지라 한다.

### **1.1 HTTP 메시지 구조**

| 메시지 헤더 |
| --- |
| 개행 문자 |
| 메시지 바디 |

**[메시지 헤더]**

서버와 클라이언트가 처리해야 하는 리퀘스트와 리스폰스 내용과 속성 등…

- **리퀘스트 라인** : 메소드, 리퀘스트 URI, HTTP 버전 포함
- **상태 라인** : 리스폰스 결과 상태 코드, 설명, HTTP 버전 포함
- **헤더 필드** : 리퀘스트/리스폰스의 조건과 속성을 나타내는 헤더 필드들 포함.
총 4종류로 `일반 헤더필드`, `리퀘스트 헤더 필드`, `리스폰스  헤더 필드`, `엔티티 헤더필드`가 있음
- **그 외** : HTTP의 RFC에 없는 해더 필드(쿠키 등) 포함

**[메시지 바디]**

전송되는 데이터 자체로 값이 없을 수 도 있음

# 2. HTTP 데이터 전송과 인코딩

---

HTTP로 데이터를 전송하는 경우 인코딩을 통해 전송 효율을 높일 수 있다. 그러나 인코딩으로 인해 CPU등 리소스 소비가 발생한다.

### 2.1 메시지 바디와 엔티티 바디의 차이

- **메시지** : HTTP 통신의 기본 단위로 통신을 통해서 전송 된다.
- **엔티티** : 리퀘스트와 리스폰스의 페이로드(부가물)로 엔티티 헤더 필드와 엔티티 바디로 구성된다.

메시지 바디는 엔티티 바디를 운반한다. 기본적으로 메시지 바디와 엔티티 바디는 같으나 전송 코딩이 적용된 경우 엔티티 바디의 내용이 변화 된다.

### 2.2 콘텐츠 코딩

**콘텐츠 코딩**이란 엔티티에 적용하는 인코딩으로 엔티티 정보를 유지한 채로 **압축**하는 것을 의미한다.

콘텐츠 코딩은 수신 측에서 디코딩 되어진다.

### 2.3 청크 전송 코딩

사이즈가 큰 데이터를 전송하는 경우 **엔티티 바디를 분할해 전송**하는 데, 이를 **청크 전송 코딩**이라 한다.

청크 전송 코딩된 엔티티 바디는 수신한 클라이언트 측에서 디코딩해 원래의 엔티티로 변환한다.

* 청크 사이즈를 16진수로 사용해 단락을 표시하고 엔티티 바디 끝에는 “0(CR+LF)”를 기록해둔다.

# 3. 멀티 파트

---

`MINE(Multipurpose Internet Mail extensions` 다목적 인터넷 메일 확장 사양)은 메일로 텍스트나 영상, 이미지와 같은 여러 다른 데이터를 아스키 문자열에 인코딩 하는 방법과 종류를 나타내는 방법 등을 규정하고 있다. 이는 `멀티파트(Multipart)`라고 하는 여러 다른 종류의 데이터를 수용한다.

HTTP도 멀티파트에 대응하고 잇어 메시지 바디 내부에 엔티티를 여러 개 포함 시켜 보낼 수 있다.

- **헤더 필드** : Content-type
- **“boundary”** :  엔티티 구분, 앞 뒤에 `“—”` 를 삽입한다.

멀티 파트는 파트마다 헤더 필드가 포함된다. 또한 멀티 파트 내부에 멀티 파트를 포함할 수도 있다.

**멀티 파트 종류**

<aside>

- multipart/form-data
- multipart/byteranges
- multipart/form-data
- mulipart/byteranges
</aside>

# 4. 레인지 리퀘스트

---

기존에는 대용량의 이미지 데이터를 다운로드하다 커넥션이 끊어지게 되면 처음부터 다시 다운로드를 해야했다. 이러한 문제를 해결하기 위해 **이전에 다운로드 한 곳에서 다운로드를 재개**하는 `리줌(resume)` 기능을 사용하게 됐다.

리줌을 실현하기 위해 **범위를 지정해 Request**하는 것이 `레인지 리퀘스트(Range Request)`이다.

- **헤더 필드** : Range

# 5. 콘텐츠 네고시에이션

---

`콘텐츠 네고시에이션(Content Negotiation)`이란 같은 콘텐츠(내용)이지만 여러 개의 페이지를 지닌 웹 페이지를 의미한다.

예를 들어, 내용은 같으나 영어판과 한국어판이 같이 표시되는 웹 페이지가 있다.

**콘텐츠 네고시에이션 종류**

- **서버 구동형 네고시에이션** : 서버 측에서 리퀘스트 헤더 필드 정보를 참고해 자동 선택하는 경우
- **에이전트 구동형 네고시에이션** : 유저가 수동으로 선택하는 경우
- **트랜스페어런트 네고시에이션** : 서버 구동형과 에이전트 구동형 혼합
